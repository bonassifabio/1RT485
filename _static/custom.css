/* Hide scrollbar for primary and secondary sidebars */
.bd-sidebar-primary,
.bd-sidebar-secondary {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
    overflow-y: auto !important; /* Keep it scrollable but hide the bar */
}

.bd-sidebar-primary::-webkit-scrollbar,
.bd-sidebar-secondary::-webkit-scrollbar {
    display: none; /* Chrome, Safari and Opera */
}

html[data-theme="dark"] img, 
html[data-theme="dark"] .cell_output img, 
html[data-theme="dark"] .rendered_html img {
    filter: invert(1) hue-rotate(180deg) !important;
    mix-blend-mode: normal !important; 
    isolation: isolate;
    background-color: transparent !important;
}

/* --- Base Styles for Caption --- */
.viewer-title {
    font-size: 1.25rem !important;
    line-height: 1.4;
    font-weight: 500;
    white-space: normal; /* Allow wrapping */
    padding-bottom: 10px;
    opacity: 1 !important; /* Ensure it isn't transparent */
    transition: color 0.3s ease, text-shadow 0.3s ease;
}

/* --- LIGHT MODE SETTINGS --- */
/* Target the title when the website is in Light Mode */
html[data-theme="light"] .viewer-title {
    color: #222222 !important; /* Dark gray, almost black */
    
    /* Create a "halo" effect using multiple light shadows.
       This mimics the light background color to separate text from the image. */
    text-shadow: 
        0 0 3px rgba(255, 255, 255, 0.9), 
        0 0 6px rgba(255, 255, 255, 0.6);
}

/* --- DARK MODE SETTINGS --- */
/* Target the title when the website is in Dark Mode */
html[data-theme="dark"] .viewer-title {
    color: #f0f0f0 !important; /* Light gray, almost white */
    
    /* Create a "halo" effect using multiple dark shadows.
       This mimics the dark background color. */
    text-shadow: 
        0 0 3px rgba(0, 0, 0, 0.9), 
        0 0 6px rgba(0, 0, 0, 0.6);
}

/* Only force the background color when the viewer is actually showing (has the 'viewer-in' class) */
.viewer-backdrop.viewer-in {
    background-color: var(--pst-color-background) !important;
    opacity: 1 !important; 
}

/* Ensure the backdrop is invisible when the viewer is closed or closing */
.viewer-backdrop {
    background-color: transparent;
}

/* Make toolbar buttons more visible against the solid background */
.viewer-toolbar > li {
    background-color: rgba(128, 128, 128, 0.5); /* Neutral gray for visibility in both modes */
    border-radius: 50%;
}
.viewer-toolbar > li:hover {
    background-color: var(--pst-color-primary); /* Use theme primary color on hover */
    color: white;
}